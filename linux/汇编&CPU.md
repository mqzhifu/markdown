

# ASCII

american standard code for information interchange : 美国信息交换标准码

以8个二进制，共256个

国标码，以16个二进制位，高8位表示汉字的区号，低8位表示汉字符的位号


# 指令集

将特定一组二进制数写到CPU某个位置，告诉计算机，这条指令应该做什么，比如：算术运算，读取地址等

CPU主要看指令集，高级语言最终要转换成CPU指令然后执行，INTEL的是X86指令集

指令：操作码\(8位\)和地址码，操作码其实就是指令序列号。地址码：主要包括源操作数地址、目的地址和下一条指令的地址

指令集：复杂指令Complex Instruction Set Computer，精简指令 Reduced Instruction Set Computer

操作码只有8位，如果放太多指令，会影响执行效率，所以RISC 补充广泛应用

CPU组成：控制器 运算器

控制器：核心，控制着 运算器 和 存储单元，指令控制器 时序控制器 总线控制器 中断控制器

运算器：（Arithmetic Logic Unit）算术运算，加减乘除~逻辑运算，位和异或等，存储单元：片内缓存和寄存器组，寄存器组又分为专用寄存器组和通用寄存器组、段寄存器

CPU内部：超标量 流水线

超标量：集成多个ALU

流水线：一条指令执行的周期：取指令，指令译码，取操作数，运算（ALU），写结果。其中前3步控制器，后两步是运算器，那么发现其实控制器的运算速度要大于运算器，也就是阻塞，而如果流水线式，前3步不等后两步，而是不停的执行下一线指令。但面临一个问题，资源抢占，比如第二条指令需要第一条指令的执行结果。乱序执行：两条指令中间插入其它进程的指令。

CPU20根地址总线: 2^20 = 1024 B \* 1024 B = 1KB \* 1024 = 1MB

范围：00000H~fffffH

然后，将上面1M再划分成若干的段

逻辑段的开始地址：必须是16的整数倍：bbbbbbbbbb0000转xxxx0 H

逻辑段的最大长度64KB ：64 \* 1024B ，范围1000 ~ 1111 ，最少是16个段，最多是64个段

物理地址= 逻辑地址 \*16 \+ 偏移地址

AH&AL＝AX\(accumulator\)：累加寄存器

BH&BL＝BX\(base\)：基址寄存器

CH&CL＝CX\(count\)：计数寄存器

DH&DL＝DX\(data\)：数据寄存器

SP（Stack Pointer）：堆栈指针寄存器

BP（Base Pointer）：基址指针寄存器

SI（Source Index）：源变址寄存器

DI（Destination Index）：目的变址寄存器

IP（Instruction Pointer）：指令指针寄存器

CS（Code Segment）代码段寄存器

DS（Data Segment）：数据段寄存器

SS（Stack Segment）：堆栈段寄存器

ES（Extra Segment）：附加段寄存器

OF overflow flag 溢出标志 操作数超出机器能表示的范围表示溢出,溢出时为1.

SF sign Flag 符号标志 记录运算结果的符号,结果负时为1.

ZF zero flag 零标志 运算结果等于0时为1,否则为0.

CF carry flag 进位标志 最高有效位产生进位时为1,否则为0.

AF auxiliary carry flag 辅助进位标志 运算时,第3位向第4位产生进位时为1,否则为0.

PF parity flag 奇偶标志 运算结果操作数位为1的个数为偶数个时为1,否则为0.

DF direcion flag 方向标志 用于串处理.DF=1时,每次操作后使SI和DI减小.DF=0时则增大.

IF interrupt flag 中断标志 IF=1时,允许CPU响应可屏蔽中断,否则关闭中断.

TF trap flag 陷阱标志 用于调试单步操作.

总线其实可以理解成：公共的线路，bus这个单词就有体会

内部总线\(片内总线\)：寄存器之间，寄存器秘ALU

外部总结\(系统总线\)：数据总线DB\(Data Bus\)、地址总线AB\(Address Bus\) 、控制总线CB\(Control Bus\)。

数据总线用来传输数据信息\(双向\)

地址总线用于传送CPU发出的地址信息\(单向\)

控制总线：总结是公共的，数据总线与地址总线同一时间应用，会冲突，控制总结用来传送控制信号、时序信号和状态信息等。

BIU，总线接口单元， EU，执行单元， IU指令单元 AU地址单元

8086CPU：16位芯片 ，20位地址线

8086/8088:通用寄存器\(数据寄存器 指针寄存器 变址寄器 \)、段寄存器、标志寄存器。

数据寄存器：AX BX CX DX

指针寄存器：SP BP

变址寄：SI DI

段寄存器：CS DS SS ES

控制寄存器：IP FLAG

数据寄存器 指针寄存器 变址寄统称为通用寄器，因为除了特殊的用途外，还可以存储其它类型的数据

CF（Carry Flag）进位标志：用于反映运算是否产生进位或借位。如果运算结果的最高位产生一个进位或借位，则CF置1，否则置0。运算结果的最高位包括字操作的第15位和字节操作的第7位。移位指令也会将操作数的最高位或最低位移入CF。

PF（Parity Flag）奇偶标志：用于反映运算结果低8位中“1”的个数。“1”的个数为偶数，则PF置1，否则置0。

AF（Auxiliary Carry Flag）辅助进位标志：在字节操作时低半字节向高半字节进位或借位,字操作时低字节向高字节进位或借位，AF置1，否则置0。

ZF（Zero Flag）零标志：用于判断结果是否为0。运算结果0，ZF置1，否则置0。

SF（Sign Flag）符号标志：用于反映运算结果的符号，运算结果为负，SF置1，否则置0。因为有符号数采用补码的形式表示，所以SF与运算结果的最高位相同。

OF（Overflow Flag）溢出标志：反映有符号数加减运算是否溢出。如果运算结果超过了8位或者16位有符号数的表示范围，则OF置1，否则置0。

控制标志：

TF（Trap Flag）陷阱标志：当TF被设置位1时，CPU进入单步模式，所谓单步模式就是CPU在每执行一步指令后都产生一个单步中断。主要用于程序的调试。8086/8088中没有专门用来置位和清零TF的命令，需要用其他办法。

IF（Interrupt Flag）中断标志：决定CPU是否响应外部可屏蔽中断请求。IF为1时，CPU允许响应外部的可屏蔽中断请求。

DF（Direction Flag）方向标志：决定串操作指令执行时有关指针寄存器调整方向。当DF为1时，串操作指令按递减方式改变有关存储器指针值，每次操作后使SI、DI递减。

立即寻址：操作数就在指令中，如：mov AX,8888H

寄存器寻址：操作数在CPU内部寄存器中，如：mov AL,AH

直接寻址：操作数在内存中，这就需要寻找物理地址了（一般操作数是存在DS段中）：DS段值\*16\+操作数的内存地址里的数据~如：mov AX,\[1234H\]

寄存器间接寻址：操作数在内存中，操作数有效地址在：SI DI BX BP 。如：mov AX,\[SI\]，SI DI BS 的段是DS，于是根据DS里的值再\+上SI的偏移量，计算出 物里内存地址

寄存器相对寻址：操作数在内存中，操作数有效地址是：基址寄存器\(BX BP\)或变址寄存器\(SI DI\) \+ 位移量，如：mov AX,\[si\+4585H\]

基址\+变址寻址：操作数在内存中，如：mov AX,\[bx\+di\]

相对基址\+变址寻址：如：mov AX,\[BS\+DI\-2\]

指令系统：数据传送 算术运算 逻辑运算 串操作 程序控制 处理器控制

mov dst,src

det src 必须类型一致，如：mov 字节，字 这是错误的

SRC与DST 不可同时为段寄存器，IP即不能为SRC也不能为DST

立即数不能直接传送到段寄存器，立即数不能为 目的操作数

xchg 1,2:交换

lea 1,2:将 2 的偏移地址 传送给1（是地址，不是地址里面的数据）

LDS 1 2：把2的 段值给ds,偏移量给1

lahf :将标志寄存器低8位 转给AH

sahf:将AH的低8位转给标志寄存器

clc

stc

加减不区分：有无符号，乘除需要区分

算术运算会影响 标志寄存器

ADD 1,2 :1\+2 结果送给1

ADC：带进位的加法，适用于多字节运算，如果16位的CPU，要计算32位的操作，只能 分成两次，于是进位标志就有用了

INC 加1指令，影响标志寄存器

DEC 减1指令，影响标志寄存器

SUB 1，2：1\-2,结果放入1，影响标志寄存器

SBB：带借位的减法,影响标志寄存器

NEG：按位取返,影响标志寄存器

CMP 1 ,2 :1 减去 2 结果不保存，但影响 标志寄存器

MUL TT :无符号 乘法，如果TT是字节，则AL_TT,16位结果发送AX，如果TT是字，AX_TT，32结果送到DX\+AZ

IMUL TT:有符号乘法

DIV TT：无符号除尘，如果TT是字节，则AX / tt =al,如果TT是字，则 \(dx\+ax\) / tt \> ax

IDIV tt:有符号 除法

左移 sal/shl

右移 sar/shr

循环左移rol

循环右移ror

jmp 标号，无条件段内跳转

运算器中有3个寄存器和一个算术逻辑电路ALU

MAR:memory adress register,存储欲访问的存储单元的地址

MDR:memory data register,存储某单元取出的代码，或者准备往某存储单元存入的代码

两个寄存器均在CPU中

控制器：计算机的核心，程序计数器\(program counter\)，指令寄存器\(instruction register \), control unit 织成

PC:存储当前欲执行指令的地址，它与MAR 有一条直接通路

IP: 当前执行指令，内容来自MDR

寄存器\-》调整缓存器\-》主存\-》辅存

