---
mindmap-plugin: basic
---

# 概览

MessageQueue：用一个容器(队列)来收/发消息
通过 MQ 解决现实场景中的一些问题

# 队列的主要用处

1. 解耦：程序员，负责各自的项目，如果出现关联，互相发个消息即可。不用互相发请求
2. 削峰：同一时间出现大量访问，先缓存到队列中，后续慢慢处理。并发转串化
3. 异步：前端想要发送邮件直接给队列发条消息即可，避免阻塞
4. 功能：优先集、延迟

# 队列功能-分类

- 优先级队列：消息被加上权重，权重高的被提高位置，优先消费
- 延迟队列：发送一条消息，定时 XX 分钟后，才能被消费
- 死信队列：消息发送错误、消息过期、队列满了，得有特定队列接收

# 消息传送模式

#### 消费者
- pull，生产者推，消费者拉
- push，生产者推，中间件再直接推给消息者

#### 发送者
- 广播：一条消息可以被所有监听者消费
- 若干组：一条消息可以被特定的监听者消费
- 一对一：只给某一队列发送消息

# 消息持久化

- 消息是否可以持久化到磁盘
- 消息被消费后，是否删除


# 容灾

- 消息是否支持分区备份
- 是否支持主从模型
- 是否支持集群模式
- 是否支持做工模式
- 是否支持动态主从切换

# MQ协议：
- AMQP
- MQTT
- STOMP
- XMPP

# MQ支持多语言SDK
- php
- golang
- java
- python
- c++


# 流控制

- stop-and-wait
- 滑窗
- 令牌桶

保证发送方的速度跟接收方的速度匹配

# 可靠性

- 发送者-是否支持 ACK 确认机制
- 消费者-是否支持 ACK 确认机制
- 重试机制

#### ACK确认策略
- 不确认
- 只确认一次
- 确认2次

#### ACK确认方式
- 自动
- 手动

#### 问题
- 丢消息
- 重复消费

# 性能

- 发送者-QPS
- 消费者-QPS

# UI

是否有：功能完善的UI管理系统

消息顺序性：保证按照时间顺序存储

