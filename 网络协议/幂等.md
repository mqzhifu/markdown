# token


# 分布式锁

每次请求过来，就去 REDIS 里设置一个值，如果设置成功，继续执行，如果设置失败，证明：此时正在有其它进程在处理，证明这次请求是重复的。

key 的设计 ：UID+业务名+唯一值

问题：
- 并发，两个请求同时到达后端，redis 必须保证一致性，只有一个请求能拿到锁
- 请求拿到锁了，但是执行的时候挂了，其它请求拿不到锁
>给锁设定一个失效时间



# 乐观锁

给数据库表增加一个 version 字段，可以通过这个字段来判断是否已经被修改了